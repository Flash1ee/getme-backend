\chapter{Аналитическая часть}

В данном разделе будет формализована система взаимодействия ментора с менти, представлены требования к системе.
Будет представлен анализ способов хранения данных и выбран оптимальный для решения задач. Будет приведена диаграмма вариантов использования.
Приведен анализ существующих решений.

\section{Формализация задачи}

Ментор - человек, работающий в IT индустрии. Он имеет опыт и экспертизу в сферах информационных технологий, предлагает свои услуги по обучению других людей.

Для менти необходима возможность найти ментора по навыкам, которые ему необходимо изучить (например, разработка операционных систем). В результате поиска с фильтрацией, в выдачу попадут лишь менторы, удовлетворяющие потребностям менти.

Ментор может просматривать список активных заявок на наставничество.
В личном кабинете имеется список активных заявок, среди которых наставник выбирает себе менти.


После утверждения заявки, у ментора появляется возможность составлять планы развития для менти.
План состоит из задач, у которых есть состояние готовности, срок выполнения.
Менти должен по мере выполнения, отмечать задачи как выполненные.
%Данные о выполнении будут использоваться для построения системы мотивации, например, рейтинга, благодаря которому
%наставники могут оценивать усердие и мотивированнность подопечных.
%
%Статистика выполнения может использоваться для мотивации подопечного к обучению, подсчета его рейтинга, который влияет на возможность попасть к наставнику:
%на фоне остальных заявок, больший рейтинг повысит вероятность выбора подопечного из-за большего усердия и мотивированности.

Задачи ментора:
\begin{itemize}
    \item получение советов, рекомендаций по карьерному росту;
    \item составление плана развития.
\end{itemize}

Возможности менти:
\begin{itemize}
    \item изучить навыки, требуемые в работе;
    \item повысить профессиональный уровень;
    \item узнать о работе в разных компаниях, разных сферах;
    \item эффективно обучаться под руководством профессионалов.
\end{itemize}

\imgw{usecase}{h!}{1.0\textwidth}{Диаграмма использования приложения}

\section{Базы данных и системы управления базами данных}

Для хранения данных в системе важную роль имеет выбор модели хранения данных.  

Для персистентного хранения данных используются базы данных \cite{database}.
Для управления этими базами используется системы управления базами данных -- СУБД \cite{subd}.

\section{Хранение данных}

Система, разрабатываемая в рамках курсового проекта, предполагает собой микросервисное приложение \cite{microservice}.

Доступ к системе имеет разграничение по ролям: ментор, менти, администратор. При этом, должно быть ограничение доступа к данным в зависимости от роли пользователя.  
Администратор имеет доступ к всей системе целиком.

Для хранения данных необходимо использовать строго структурированную и типизированную базу данных, так как:
\begin{itemize}
	\item все роли имеют отношения между собой;
	\item доступ к данным разграничен;
	\item у предметной области есть структура, которую можно предописать заранее.  
\end{itemize}

Данные в приложении делятся на следующие типы:
\begin{itemize}
    \item сессии;
    \item пользовательские;
    \item заявки на обучение;
    \item планы;
    \item задачи в рамках плана;
    \item связи между менторами и менти.
\end{itemize}

\section{Хранение пользовательских данных и данных о планах обучения}

Разрабатываемая система предполагает хранение данных о пользователях, связях между наставниками и подопечными, а также планов развития.
Поэтому необходимо предусмотреть наличие нескольких ролей, пользователей, каждый из которых будет
иметь возможность загружать свои наборы данных, взаимодейстовать с своей частью системы.

\subsection{Классификация баз данных по способу обработки}

По способу обработки базы данных делятся на две группы -- реляционные и нереляционные базы данных. Каждый из двух типов служит для выполнения определенного рода задач.

\subsubsection{Реляционные базы данных (SQL)}

Данные реляционных баз хранятся в виде таблиц и строк, таблицы могут иметь связи с другими таблицами через внешние ключи, таким образом образуя некие отношения.

Реляционные базы данных используют язык SQL. Структура таких баз данных позволяет связывать информацию из разных таблиц с помощью внешних ключей (или индексов), которые используются для уникальной идентификации любого атомарного фрагмента данных в этой таблице. Другие таблицы могут ссылаться на этот внешний ключ, чтобы создать связь между частями данных и частью, на которую указывает внешний ключ.

SQL используют универсальный язык структурированных запросов для определения и обработки данных. Это накладывает определенные ограничения: прежде чем начать обработку, данные надо разместить внутри таблиц и описать.

\subsubsection{Нереляционные базы данных (NoSQL)}

Данные нереляционных баз данных не имеют общего формата. Они могут представляться в виде документов (Mongo \cite{mongodb}, Tarantool \cite{tarantool}), пар ключ-значение (Redis \cite{redis}), графовых представляниях.

Динамические схемы для неструктурированных данных позволяют:

\begin{itemize}
    \item ориентировать информацию на столбцы или документы;
    \item основывать ее на графике;
    \item организовывать в виде хранилища Key-Value;
    \item создавать документы без предварительного определения их структуры, использовать разный синтаксис;
    \item добавлять поля непосредственно в процессе обработки.
\end{itemize}

%\subsubsection{Выбор модели хранения данных для решения задачи}
%
%Для решения задачи SQL базы данных выглядят более применимо в контексте работы по нескольким причинам:
%
%\begin{itemize}
%    \item задача предполагает наличие отношений;
%    \item данные имеют четкую структуру, которую можно представить в виде таблиц;
%\end{itemize}

\subsection{Классификация баз данных по способу хранения}

Базы данных, по способу хранения, делятся на две группы -- строковые и колоночные. Каждый из этих типов служит для выполнения для определенного рода задач.

\subsubsection{Строковые базы данных}

Строковыми базами даных называются такие базы данных, записи которых в памяти представляются построчно.
Строковые баз данных используются в транзакционных системах (англ. OLTP \cite{OLTP}). Для таких систем характерно большое количество коротких транзакций с операциями вставки, обновления и удаления данных - \texttt{INSERT}, \texttt{UPDATE}, \texttt{DELETE}.

Основной упор в системах OLTP делается на очень быструю обработку запросов, поддержание целостности данных в средах с множественным доступом и эффективность, которая измеряется количеством транзакций в секунду.

Схемой, используемой для хранения транзакционных баз данных, является модель сущностей, которая включает в себя запросы, обращающиеся к отдельным записям. Так же, в OLTP-системах есть подробные и текущие данных.\\

\subsubsection{Колоночные базы данных}

Колоночными базами данных называются базы данных, записи которых в памяти представляются по столбцам. Колоночные базы данных используется в аналитических системах (англ. OLAP \cite{OLAP}). OLAP характеризуется низким объемом транзакций, а запросы часто сложны и включают в себя агрегацию. Время отклика для таких систем является мерой эффективности.

OLAP-системы широко используются методами интеллектуального анализа данных. В таких базах есть агрегированные, исторические данные, хранящиеся в многомерных схемах.

\subsection{Выбор модели хранения данных для решения задачи}

Для решения задачи построчное хранение данных преобладает над колоночным хранением по нескольким причинам:

\begin{itemize}
    \item задача предполагает постоянное добавление и изменение данных;
    \item задача предполагает быструю отзывчивость на запросы пользователя;
    \item задача не предполагает выполнения аналитических запросов;
\end{itemize}

%\subsection{Обзор СУБД с построчным хранением}
%
%В данном подразделе буду рассмотрены популярные построчные СУБД, которые могут быть использованы для реализации хранения в разрабатываемом программном продукте.\\
%
%\subsubsection{PostgreSQL}
%
%PostgreSQL \cite{postgresql} -- это свободно распространяемая объектно-реляционная система управления базами данных, наиболее развитая из открытых СУБД в мире \cite{db-engines-rating-relational}.
%
%PostgreSQL предоставляет транзакции со свойствами атомарности, согласованности, изоляции, долговечности (ACID \cite{ACID}), автоматически обновляемые представления, материализованные представления, триггеры, внешние ключи и хранимые процедуры.
%
%Рассматриваемая СУБД управляет параллелизмом с помощью технологии управления многоверсионным параллелизмом (англ. MVCC \cite{MVCC}).
%Эта технология дает каждой транзакции <<снимок>> текущего состояния базы данных, позволяя вносить изменения, не затрагивая другие транзакции. Это в значительной степени устраняет необходимость в блокировках чтения и гарантирует, что база данных поддерживает принципы ACID. \\
%
%\subsubsection{Oracle Database}
%
%Oracle Database -- объектно-реляционная система управления базами данных компании Oracle \cite{oracle}. На данный момент, рассматриваемая СУБД является самой популярной в мире.
%
%Все транзакции Oracle Database соответствуют обладают свойствами ACID, поддерживает триггеры, внешние ключи и хранимые процедуры. Данная СУБД подходит для разнообразных рабочих нагрузок и может использоваться практически в любых задачах. Особенностью Oracle Database является быстрая работа с большими массивами данных.
%
%Oracle Database может использовать один или более методов параллелизма. Сюда входят механизмы блокировки для гарантии монопольного использования таблицы одной транзакцией, методы временных меток, которые разрешают сериализацию транзакций и планирование транзакций на основе проверки достоверности. \\
%
%\subsubsection{MySQL}
%
%MySQL \cite{mysql} -- свободная реляционная система управления базами данных. Разработку и поддержку MySQL осуществляет корпорация Oracle.
%
%Рассматриваемая СУБД имеет два основных механизма хранения данных: InnoDB и myISAM.
%InnoDB полностью полностью совместим с принципами ACID, в отличии от myISAM.
%СУБД MySQL подходит  для использования при разработке веб-приложений, что объясняется очень тесной интеграцией с популярными языками PHP и Perl.
%
%Реализация параллелизма в СУБД MySQL реализовано с помощью механизма блокировок, который обеспечивает одновременный доступ к данным.

%\subsection{Выбор СУБД для решения задачи}
%
%Для решения задачи была выбрана СУБД PostgreSQL, потому что данная СУБД проста в развертывании, является свободно-распространяемым ПО, эффективно по быстродействию и обладает исчерпывающим функционалом.

\section{Хранение данных сессий}

Для хранения состояний системы, в частности, авторизации пользователей, следует использовать базу данных.
Эти данные должны храниться отдельно от пользовательских с целью безопасности и отказоустойчивости, их обработкой занимается отдельный сервис.
Особенность таких данных в том, что у них нет отношений и связей, они хранятся парами key-value.
Главное требование - данная база должна отличаться быстродействием.

Для решения таких задач следует рассмотреть in-memory СУБД.

In-Memory —- это набор концепций хранения данных, когда они сохраняются в оперативной памяти приложения, а диск используется для бэкапа. В классических подходах данные хранятся на диске, а память — в кэше.

%\subsection{Обзор in-memory СУБД}
%
%\subsubsection{Tarantool}
%
%Tarantool \cite{tarantool} -- это платформа in-memory вычислений с гибкой схемой хранения данных для эффективного создания высоконагруженных приложений. Включает себя базу данных и сервер приложений на языке программирования Lua.
%
%Tarantool обладает высокой скоростью работы по сравнению с традиционными СУБД.
%
%Для хранения данных используется кортежи (англ. tuple) данных.
%Кортеж -- это массив не типизированных данных. Кортежи объединяются в спейсы (англ. space), аналоги таблицы из реляционной модели хранения данных.
%Спейс -- коллекция кортежей, кортеж -- коллекция полей.
%
%В рассматриваемой СУБД реализованы два механизма хранения данных.
%Первый хранит все данные в оперативной памяти, а второй на диске. Для каждого спейса можно задавать различный механизм хранения данных.
%
%Каждый спейс должен быть проиндексирован первичным ключом. Кроме того, поддерживается неограниченное количество вторичных ключей. Каждый из ключей может быть составным.
%
%В Tarantool реализован механизм <<снимков>> текущего состояния хранилища и журналирования всех операций, что позволяет восстановить состояние базы данных после ее перезагрузки.\\
%
%\subsubsection{Redis}
%
%Redis \cite{redis} -- резидентная система управлениями базами данных класса NoSQL с открытым исходным кодом. Основной структурой данных, с которой работает Redis является структура типа <<ключ-значение>>. Данная СУБД используется как для хранения данных, так и для реализации кэшей и брокеров сообщений.
%
%Redis хранит данные в оперативной памяти и снабжена механизмом <<снимков>> и журналирования, что обеспечивает постоянное хранение данных. Предоставляются операции для реализации механизма обмена сообщениями в шаблоне <<издатель-подписчик>>: с его помощью приложения могут создавать программные каналы, подписываться на них и помещать в эти каналы сообщения, которые будут получены всеми подписчиками. Существует поддержка репликации данных типа master-slave, транзакций и пакетной обработки комманд.
%
%Все данные Redis хранит в виде словаря, в котором ключи связаны со своими значениями. Ключевое отличие Redis от других хранилищ данных заключается в том, что значения этих ключей не ограничиваются строками. Поддерживаются следующие абстрактные типы данных:
%
%\begin{itemize}
%    \item строки;
%    \item списки;
%    \item множества;
%    \item хеш-таблицы;
%    \item упорядоченные множества.
%\end{itemize}
%
%Тип данных значения определяет, какие операции доступные для него; поддежриваются высокоуровневые операции: например, объединение, разность или сортировка наборов.

%\subsection{Выбор СУБД для решения задачи}
%
%Для хранения сессионных данных была выбрана СУБД Redis, так как она проста в развертывании и переносимости,
%обладает требуемым типом хранения - key-value и хранится в оперативной памяти. Tarantool более функциональная база данных, для решения
%задачи слишком нагружена.

\section{Формализация данных}

\subsection{База данных пользователей, планов развития и отношений между ролями}

Хранение данных пользователей, планов развития и отношений между ролями должны храниться в одной базе данных.
Пользователи должны иметь уникальные идентификаторы, чтобы их можно было однозначно идентифицировать.

Наставники и подопечные связаны отношением N:M, информация об этих связях должна сохраняться.

Каждый план должен хранить идентификатор наставника и подопечного, чтобы идентифицировать роли.

\subsection{База данных сессий}
Современные веб приложения построены на основе HTTP протокола, который не сохраняет свое состояние (stateless\cite{stateful-stateless}), каждый запрос
является независимой транзакцией.
Это значит, что отслеживание взаимодействия с клиентами (пользователями) нужно реализовывать самостоятельно.
Это нужно для того, чтобы клиенту не приходилось на каждый запрос проходить аутентификацию в системе, он мог в течение некоторого промежутка
времени пользоваться системой без повторной аутентификации.

Сессии\cite{sessions} позволяют отслеживать "состояния" между сайтом и каким-либо клиентом.
Они позволяют хранить произвольные данные и получать их в момент установления соединения между клиентом и сервером.
Данные получаются и сохраняются в сессии при помощи "ключа".

База данных сессий должна хранить пары значений: \textit{уникальный идентификатор сессии} - \textit{уникальный идентификатор пользователя}.
Данные должны отдаваться быстро и иметь устойчивость к отказу, например, сохраняться на твердотельный накопитель с возможностью восстановления.

\section{Вывод}

В данном разделе:

\begin{itemize}
    \item рассмотрена структура базы данных для системы;
    \item привелена диаграмма использования приложения;
    \item проанализированы способы хранения информации для системы;
    \item проведен анализ СУБД, используемых для решения задачи;
    \item формализованны данные, используемые в системе;
\end{itemize}
